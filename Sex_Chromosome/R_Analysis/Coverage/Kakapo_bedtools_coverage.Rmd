---
title: "Kakapo_bedtools_coverage"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Bedtools Coverage tutorial

To save memory use colClasses and NULLs this is useful because I'm just interested in a single column.
To do the sanity check for each of these variables, run the head(x) and table(x$V8>0) commands.

```{r cars}
pos22 <- read.table("/media/jana/Data/kakapo125/test/Adelaide_22_1bpWindow_pos.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
neg22 <- read.table("/media/jana/Data/kakapo125/test/Adelaide_22_1bpWindow_neg.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
pos23 <- read.table("/media/jana/Data/kakapo125/test/Adelaide_23_1bpWindow_pos.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
neg23 <- read.table("/media/jana/Data/kakapo125/test/Adelaide_23_1bpWindow_neg.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
posZ <- read.table("/media/jana/Data/kakapo125/test/Adelaide_Z_pos.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
negZ <- read.table("/media/jana/Data/kakapo125/test/Adelaide_Z_neg.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
posW <- read.table("/media/jana/Data/kakapo125/test/Adelaide_W_pos.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
negW <- read.table("/media/jana/Data/kakapo125/test/Adelaide_W_neg.tsv.gz",
                  header=FALSE,
                  colClasses=c(rep('NULL',7),NA)
                  )
pos23_1kbp <- read.table("/media/jana/Data/kakapo125/test/first1000bp_chr23.tsv",
                         header=FALSE,
                         colClasses=c(rep('NULL',7),NA)
                         )
neg23_1kbp <- read.table("/media/jana/Data/kakapo125/test/first1000bp_chr23_neg.tsv",
                         header=FALSE,
                         colClasses=c(rep('NULL',7),NA)
                         )
pos23_200 <- read.table("/media/jana/Data/kakapo125/test/Adelaide_chr23_200bp.tsv",
                         header=FALSE,
                         colClasses=c(rep('NULL',7),NA)
                         )
neg23_200 <- read.table("/media/jana/Data/kakapo125/test/Adelaide_chr23_200bp_neg.tsv",
                         header=FALSE,
                         colClasses=c(rep('NULL',7),NA)
                         )
```

## Plotting coverage data for chromosome 22

The data has loaded into R as simple data frames; now to produce plots

```{r pressure, echo=FALSE}
names(pos22) <- 'coverage'
names(neg22) <- 'coverage'
pos22$position <- 0:556941
neg22$position <- 0:556941
#neg22$coverage <- neg22$coverage*-1
max(pos22$coverage)
min(neg22$coverage)
chr22plot <- plot(pos22$coverage,
     type='h',
     ylim=c(-2000,2000),
     col='blue',
     ylab='Coverage',
     xlab='Position',
     xaxt='n',
     main='Adelaide coverage at chr22 from 0 to 556,942bp'
     )
# plot the coverage on the reverse strand
lines(neg22$coverage,
      type='h',
      col='red'
      )
 
# generate my x-axis
l22 <- length(pos22$position)
axis(1,
     at = seq(from = 0, to = l22, by = l22/4),
     labels = seq(from = head(pos22$position,n=1)-1,
                  to=tail(pos22$position, n=1),
                  by = l22/4
                  )
     )
```

## Plotting coverage data for chromosome 23

The data has loaded into R as simple data frames; now to produce plots

```{r pressure, echo=FALSE}
names(pos23) <- 'coverage'
names(neg23) <- 'coverage'
pos23$position <- 0:378073
neg23$position <- 0:378073
#neg23$coverage <- neg23$coverage*-1
max(pos23$coverage)
min(neg23$coverage)
chr23 <- plot(pos23$coverage,
     type='h',
     ylim=c(-150,150),
     col='blue',
     ylab='Coverage',
     xlab='Position',
     xaxt='n',
     main='Adelaide coverage at chr 23 from 0 to 378,074bp'
     )
# plot the coverage on the reverse strand
lines(neg23$coverage,
      type='h',
      col='red'
      )
 
# generate my x-axis
l23 <- length(pos23$position)
axis(1,
     at = seq(from = 0, to = l23, by = l23/4),
     labels = seq(from = head(pos23$position,n=1)-1,
                  to=tail(pos23$position, n=1),
                  by = l23/4
                  )
     )
```

## Plotting coverage data for chromosome 23 - Coverage of first kbp

The data has loaded into R as simple data frames; now to produce plots

```{r pressure, echo=FALSE}
names(pos23_1kbp) <- 'coverage'
names(neg23_1kbp) <- 'coverage'
pos23_1kbp$position <- 0:999
neg23_1kbp$position <- 0:999
neg23_1kbp$coverage <- neg23_1kbp$coverage*-1
max(pos23_1kbp$coverage)
min(neg23_1kbp$coverage)
plot(pos23_1kbp$coverage,
     type='h',
     ylim=c(-15,15),
     col='blue',
     ylab='Coverage',
     xlab='Position',
     xaxt='n',
     main='Adelaide coverage at chr 23 from 0 to 1,000bp'
     )
# plot the coverage on the reverse strand
lines(neg23_1kbp$coverage,
      type='h',
      col='red'
      )
 
# generate my x-axis
l23kbp <- length(pos23_1kbp$position)
axis(1,
     at = seq(from = 0, to = l23kbp, by = l23kbp/4),
     labels = seq(from = head(pos23_1kbp$position,n=1)-1,
                  to=tail(pos23_1kbp$position, n=1),
                  by = l23kbp
                  /4
                  )
     )
```

## Plotting coverage data for chromosome 23 - Coverage of first 200bp

The data has loaded into R as simple data frames; now to produce plots

```{r pressure, echo=FALSE}
names(pos23_200bp) <- 'coverage'
names(neg23_200bp) <- 'coverage'
pos23_200$position <- 0:199
neg23_200p$position <- 0:199
neg23_200$coverage <- neg23_200$coverage*-1
max(pos23_200$coverage)
min(neg23_200$coverage)
plot(pos23_200$coverage,
     type='h',
     ylim=c(-15,15),
     col='blue',
     ylab='Coverage',
     xlab='Position',
     xaxt='n',
     main='Adelaide coverage at chr 23 from 0 to 200bp'
     )
# plot the coverage on the reverse strand
lines(neg23_200$coverage,
      type='h',
      col='red'
      )
 
# generate my x-axis
l200 <- length(pos23_200$position)
axis(1,
     at = seq(from = 0, to = l200, by = l200/4),
     labels = seq(from = head(pos23_200$position,n=1)-1,
                  to=tail(pos23_200$position, n=1),
                  by = l200/4
                  )
     )
```

## Plotting coverage data for the Z chromosome

The data has loaded into R as simple data frames; now to produce plots

```{r pressure, echo=FALSE}
names(posZ) <- 'coverage'
names(negZ) <- 'coverage'
posZ$position <- 0:101254408
negZ$position <- 0:101254408
negZ$coverage <- negZ$coverage*-1
max(posZ$coverage)
min(negZ$coverage)
plotZ <- plot(posZ$coverage,
     type='h',
     ylim=c(-3000,500),
     col='blue',
     ylab='Coverage',
     xlab='Position',
     xaxt='n',
     main='Adelaide coverage at chrZ from 0 to 101,254,409bp'
     )
# plot the coverage on the reverse strand
lines(negZ$coverage,
      type='h',
      col='red'
      )
 
# generate my x-axis
lz <- length(posZ$position)
axis(1,
     at = seq(from = 0, to = lz, by = lz/4),
     labels = seq(from = head(posZ$position,n=1)-1,
                  to=tail(posZ$position, n=1),
                  by = lz/4
                  )
     )
```

## Plotting coverage data for the W chromosome

The data has loaded into R as simple data frames; now to produce plots

```{r pressure, echo=FALSE}
names(posW) <- 'coverage'
names(negW) <- 'coverage'
posW$position <- 0:35700788
negW$position <- 0:35700788
negW$coverage <- negW$coverage*-1
max(posW$coverage)
min(negW$coverage)
chrW <- plot(posW$coverage,
     type='h',
     ylim=c(-4000,4000),
     col='blue',
     ylab='Coverage',
     xlab='Position',
     xaxt='n',
     main='Adelaide coverage at chrW from 0 to 35,700,789bp'
     )
# plot the coverage on the reverse strand
lines(negW$coverage,
      type='h',
      col='red'
      )
 
# generate my x-axis
lw <- length(posW$position)
axis(1,
     at = seq(from = 0, to = lw, by = lw/4),
     labels = seq(from = head(posW$position,n=1)-1,
                  to=tail(posW$position, n=1),
                  by = lw/4
                  )
     )
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
